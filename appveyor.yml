version: 1.0.{build}
os: Visual Studio 2015

environment:
  matrix:
  - ARCH: amd64
  - ARCH: x86

install:
- git clone https://github.com/google/googletest.git
- cd googletest
- "\"C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\vcvarsall.bat\" %ARCH%"
- cmake -G "NMake Makefiles" .
- nmake
- mkdir googletest\lib
- cp googlemock\gtest\gtest* googletest\lib
- set GTEST_ROOT=%cd%\googletest
- cd ..
- git submodule update --init --recursive

build_script:
- "\"C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\vcvarsall.bat\" %ARCH%"
- cmake -G "NMake Makefiles" .
- nmake

test_script:
- ctest -VV
